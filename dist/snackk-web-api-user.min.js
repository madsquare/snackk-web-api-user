!function(e,r){"function"==typeof define?define(["server","lodash"],r):"object"==typeof exports?module.exports=r():e.user=r()}(this,function(){var e,r,n;return function(t){function s(e,r){var n,t,s,i,o,u,a,l,c,f,p=r&&r.split("/"),d=v.map,_=d&&d["*"]||{};if(e&&"."===e.charAt(0)&&r){for(p=p.slice(0,p.length-1),e=p.concat(e.split("/")),l=0;f=e[l];l++)if("."===f)e.splice(l,1),l-=1;else if(".."===f){if(1===l&&(".."===e[2]||".."===e[0]))return!0;l>0&&(e.splice(l-1,2),l-=2)}e=e.join("/")}if((p||_)&&d){for(n=e.split("/"),l=n.length;l>0;l-=1){if(t=n.slice(0,l).join("/"),p)for(c=p.length;c>0;c-=1)if(s=d[p.slice(0,c).join("/")],s&&(s=s[t])){i=s,o=l;break}if(i)break;!u&&_&&_[t]&&(u=_[t],a=l)}!i&&u&&(i=u,o=a),i&&(n.splice(0,o,i),e=n.join("/"))}return e}function i(e,r){return function(){return p.apply(t,m.call(arguments,0).concat([e,r]))}}function o(e){return function(r){return s(r,e)}}function u(e){return function(r){d[e]=r}}function a(e){if(_.hasOwnProperty(e)){var r=_[e];delete _[e],g[e]=!0,f.apply(t,r)}if(!d.hasOwnProperty(e))throw new Error("No "+e);return d[e]}function l(e,r){var n,t,i=e.indexOf("!");return-1!==i?(n=s(e.slice(0,i),r),e=e.slice(i+1),t=a(n),e=t&&t.normalize?t.normalize(e,o(r)):s(e,r)):e=s(e,r),{f:n?n+"!"+e:e,n:e,p:t}}function c(e){return function(){return v&&v.config&&v.config[e]||{}}}var f,p,d={},_={},v={},g={},m=[].slice;f=function(e,r,n,s){var o,f,p,v,m,y,T=[];if(s=s||e,"function"==typeof n){for(r=!r.length&&n.length?["require","exports","module"]:r,y=0;y<r.length;y++)if(m=l(r[y],s),p=m.f,"require"===p)T[y]=i(e);else if("exports"===p)T[y]=d[e]={},o=!0;else if("module"===p)f=T[y]={id:e,uri:"",exports:d[e],config:c(e)};else if(d.hasOwnProperty(p)||_.hasOwnProperty(p))T[y]=a(p);else if(m.p)m.p.load(m.n,i(s,!0),u(p),{}),T[y]=d[p];else if(!g[p])throw new Error(e+" missing "+p);v=n.apply(d[e],T),e&&(f&&f.exports!==t&&f.exports!==d[e]?d[e]=f.exports:v===t&&o||(d[e]=v))}else e&&(d[e]=n)},e=r=p=function(e,r,n,s){return"string"==typeof e?a(l(e,r).f):(e.splice||(v=e,r.splice?(e=r,r=n,n=null):e=t),r=r||function(){},s?f(t,e,r,n):setTimeout(function(){f(t,e,r,n)},15),p)},p.config=function(e){return v=e,p},n=function(e,r,n){r.splice||(n=r,r=[]),_[e]=[e,r,n]},n.amd={jQuery:!0}}(),n("../almond",function(){}),function(){n("user",["server"],function(e){var r,n,t;return t=null,n={DUPLICATED:"error_duplicated",INVALID:"error_invalid",UN_KNOWN:"error_unknown"},r={setUser:function(e){return t=e},registUser:function(r,n,t){return t||(t={}),e.request(e.TAG.user.user,_.assign({data:_.assign({user:r},t)},{type:"POST"},n))},addProvider:function(r,n,s){var i;return i=e.TAG.user.provider.replace(":us_no",t.us_no).replace(":provider",r),e.request(i,_.aasign({type:"POST",data:{token:n}},s))},loadMe:function(r,n){return n||(n={}),e.request(e.TAG.user.user,_.assign({data:n},r))},loadDefaultProfile:function(r){var n;return n=e.TAG.user.profileDefault.replace(":us_no",t.us_no),e.request(n,r)},updateUser:function(r,n,s){var i;return t?(s||(s={}),i=e.TAG.user.aUser.replace(":us_no",t.us_no),e.request(i,_.assign({type:"PUT",data:_.assign({user:r},s)},n))):void console.log("updateUser] user object is empty.")},updateProfile:function(r,n){var s;return s=e.TAG.user.profile.replace(":us_no",t.us_no),e.request(s,_.assign({fileInput:r,dataType:"iframe json"},n))},updatePassword:function(r,n,s,i){var o,u,a,l;return r?(u={passwd:r},o={nonce:{isPasswdEdit:1}}):(u={},o={}),i||(i={}),l=_.assign({new_passwd:newPassWd},u),a=e.TAG.user.aUser.replace(":us_no",t.us_no),e.request(a,_.aasign({type:"PUT",data:_.assign({user:l},o,i)},s))},deleteUser:function(r){var n;return t?(n=e.TAG.user.aUser.replace(":us_no",t.us_no),e.request(n,_.assign({type:"DELETE"},r))):void console.log("deleteUser] user object is empty.")},deleteProvider:function(r,n){var s;return s=e.TAG.user.provider.replace(":us_no",t.us_no).replace(":provider",r),e.request(s,_.assign({type:"DELETE"},n))},deleteProfile:function(r){var n;return n=e.TAG.user.profile.replace(":us_no",t.us_no),e.request(n,_.assign({type:"DELETE"},r))},sendEmail:function(r){var n;return n=e.TAG.user.emailPost,e.request(n,r)},validateEmail:function(e,r){var t,s;return r&&e?(e.match(/^(([a-zA-Z]|[0-9])|([-]|[_]|[.]))+[@](([a-zA-Z0-9])|([-])){2,63}[.](([a-zA-Z0-9]){2,63})+$/gi)||r("ERROR",n.INVALID),s&&s.abort(),t={filter:{email:e}},s=this.loadUser(t,{success:function(e){return function(e){return r("ERROR",n.DUPLICATED)}}(this),error:function(e){return function(e){return 404===e.code?r("SUCCESS"):r("ERROR",n.UN_KNOWN)}}(this),complete:function(e){return function(){return s=null}}(this)})):void console.error("validateEmail] email or callback is not defined.")}}})}.call(this),n("server",function(e){return window.require("server")}),r("user")});
//# sourceMappingURL=snackk-web-api-user.min.js.map